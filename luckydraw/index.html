<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Lucky Draw â€” 5G88 Style</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0b0b0f;
    --card:#12131a;
    --ink:#e9e9f0;
    --muted:#9aa0ab;
    --gold:#f5c542;
    --gold-2:#ffd76b;
    --gold-3:#f1b70a;
    --accent:#3a8dff;
    --danger:#ff5c6a;
    --success:#25d366;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:
      radial-gradient(1200px 800px at 10% -10%, #1b1d28 0%, transparent 60%),
      radial-gradient(900px 600px at 110% 0%, #10121a 0%, transparent 55%),
      linear-gradient(180deg, #0b0b0f, #0a0a0d);
    color:var(--ink); font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
    display:flex; align-items:center; justify-content:center; padding:16px;
  }
  .app{
    width:min(1200px, 100%); display:grid; gap:18px;
    grid-template-columns: 1.2fr 1fr;
  }
  @media (max-width: 980px){
    .app{grid-template-columns: 1fr}
  }
  .card{
    background:linear-gradient(180deg, #12131a, #0f1016);
    border:1px solid #1d2030; border-radius:18px; box-shadow:0 10px 40px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.04);
    overflow:hidden;
  }
  .header{
    display:flex; align-items:center; justify-content:space-between;
    padding:14px 18px; border-bottom:1px solid #1b1e2a; background:
    linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,0));
  }
  .title{
    font-weight:800; letter-spacing:.3px; display:flex; align-items:center; gap:10px;
  }
  .title .dot{
    width:12px; height:12px; border-radius:50%;
    background: radial-gradient(circle at 30% 30%, var(--gold-2), var(--gold-3));
    box-shadow:0 0 12px 2px rgba(245,197,66,.6), 0 0 30px rgba(245,197,66,.25) inset;
  }
  .toolbar{display:flex; gap:10px; flex-wrap:wrap}
  .btn{
    appearance:none; border:none; padding:10px 14px; border-radius:12px; cursor:pointer;
    font-weight:600; color:#0b0b0f; background:linear-gradient(180deg, var(--gold), var(--gold-3));
    box-shadow:0 6px 20px rgba(245,197,66,.25), inset 0 1px 0 rgba(255,255,255,.4);
    transition:.2s transform ease, .2s box-shadow ease, .2s filter ease;
  }
  .btn:hover{transform:translateY(-1px)}
  .btn:active{transform:translateY(1px) scale(.98)}
  .btn.ghost{
    background:transparent; color:var(--ink); border:1px solid #2a2d3e; box-shadow:none;
  }
  .btn.success{ background:linear-gradient(180deg, #39e08a, #1fb86b); color:#06120b}
  .btn.danger{ background:linear-gradient(180deg, #ff6d7a, #ef3c50); color:#230509}
  .btn.full{width:100%}
  .content{padding:18px}
  .grid2{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
  @media (max-width:640px){ .grid2{grid-template-columns:1fr} }
  input[type="text"], textarea{
    width:100%; background:#0c0e14; border:1px solid #222639; color:var(--ink);
    padding:12px 12px; border-radius:12px; outline:none; font-size:14px;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
  }
  textarea{min-height:110px; resize:vertical}
  label{font-size:12px; color:var(--muted); margin-bottom:6px; display:block}
  .pill{
    display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border-radius:999px;
    background:#0e1118; border:1px solid #25283a; font-size:13px;
  }
  .names{
    display:flex; flex-wrap:wrap; gap:8px; max-height:180px; overflow:auto; padding-right:4px;
  }
  .name-pill{
    background:linear-gradient(180deg, #1a1d28, #121522);
    border:1px solid #2a2d3e; border-radius:999px; padding:8px 12px; display:inline-flex; gap:10px; align-items:center;
  }
  .name-pill b{letter-spacing:.2px}
  .name-pill button{
    background:#1f2230; color:#b6b9c5; border:1px solid #2f3346; border-radius:8px; padding:4px 8px; cursor:pointer;
  }
  .footer{
    padding:14px 18px; border-top:1px solid #1b1e2a; display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;
  }

  /* ====== Wheel Area ====== */
  .stage{
    position:relative; display:flex; align-items:center; justify-content:center; padding:18px;
    background:
      radial-gradient(800px 400px at 50% -10%, rgba(245,197,66,.08), transparent 60%),
      linear-gradient(180deg, #0e0f15, #0a0b10);
  }
  .wheel-wrap{
    position:relative; width:min(560px, 90vw); aspect-ratio:1/1;
    display:grid; place-items:center; margin:10px auto;
    filter: drop-shadow(0 30px 60px rgba(0,0,0,.45));
  }
  .ring{
    position:absolute; inset:-24px; border-radius:50%;
    background:
      radial-gradient(circle at 50% 50%, rgba(0,0,0,.25) 0 60%, transparent 61%),
      conic-gradient(from 0deg,
        #0000 0 360deg); /* placeholder */
    pointer-events:none;
  }
  /* Bulbs using mask trick */
  .ring::before{
    content:""; position:absolute; inset:0; border-radius:50%;
    background:
      radial-gradient(circle, rgba(255,255,255,.95) 0 55%, rgba(255,255,255,.0) 60%) 50% 0/10% 10% repeat,
      radial-gradient(circle at 30% 30%, var(--gold-2), var(--gold-3));
    -webkit-mask:
      radial-gradient(circle, #000 52%, #0000 53%) 50% 50%/100% 100% no-repeat,
      conic-gradient(from 0deg, #000 0 360deg);
    mask:
      radial-gradient(circle, #000 52%, #0000 53%) 50% 50%/100% 100% no-repeat,
      conic-gradient(from 0deg, #000 0 360deg);
    filter: drop-shadow(0 0 6px rgba(245,197,66,.85)) drop-shadow(0 0 14px rgba(245,197,66,.45));
    animation: bulbs-rotate 9s linear infinite;
  }
  @keyframes bulbs-rotate{
    to{ transform: rotate(360deg) }
  }
  .ring::after{
    content:""; position:absolute; inset:0; border-radius:50%;
    animation: blink 1.2s steps(2,end) infinite;
    box-shadow: inset 0 0 0 2px rgba(245,197,66,.35), inset 0 0 60px rgba(245,197,66,.18);
  }
  @keyframes blink{
    50%{ box-shadow: inset 0 0 0 2px rgba(245,197,66,.6), inset 0 0 80px rgba(245,197,66,.26); }
  }

  .wheel{
    width:100%; height:100%; border-radius:50%; background:#111; display:block;
    transform:rotate(var(--deg, 0deg)); transition: transform var(--dur, 0s) var(--easing, ease-out);
    border:10px solid #0e0f15; box-shadow:inset 0 0 0 2px #2a2d3e, 0 0 0 8px #161823, inset 0 40px 80px rgba(0,0,0,.25);
  }
  .hub{
    position:absolute; width:84px; height:84px; border-radius:50%;
    background: radial-gradient(circle at 35% 35%, #fff, #ccc 40%, #777 65%, #333 85%);
    box-shadow: 0 8px 30px rgba(0,0,0,.5), inset 0 2px 0 rgba(255,255,255,.6);
    z-index:3;
  }
  .hub::after{
    content:""; position:absolute; inset:8px; border-radius:50%;
    background: radial-gradient(circle at 35% 35%, var(--gold-2), var(--gold-3));
    box-shadow: inset 0 1px 0 rgba(255,255,255,.6), 0 0 22px rgba(245,197,66,.45);
  }
  .pointer{
    position:absolute; top:-8px; width:0; height:0; z-index:5;
    border-left:16px solid transparent; border-right:16px solid transparent; border-bottom:26px solid var(--gold);
    filter: drop-shadow(0 4px 10px rgba(0,0,0,.6));
  }
  .pointer::after{
    content:""; position:absolute; top:24px; left:-12px; right:-12px; height:8px; border-radius:6px;
    background: radial-gradient(60% 120% at 50% 0%, rgba(0,0,0,.45), rgba(0,0,0,0));
  }

  .winner-badge{
    position:absolute; bottom:16px; left:50%; transform:translateX(-50%);
    background:linear-gradient(180deg, rgba(245,197,66,.18), rgba(245,197,66,.06));
    border:1px solid rgba(245,197,66,.35); border-radius:12px; padding:10px 14px;
    font-weight:700; color:var(--gold-2); letter-spacing:.3px; backdrop-filter: blur(6px);
    box-shadow: 0 8px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.08);
    min-width:220px; text-align:center; display:none;
  }

  .list{
    display:grid; gap:12px;
  }
  .row{display:grid; gap:10px}
  .row-inline{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
  .flex{display:flex; gap:10px}
  .grow{flex:1}
  .small{font-size:12px; color:var(--muted)}

  /* Confetti canvas */
  canvas.confetti{
    position:fixed; inset:0; width:100vw; height:100vh; pointer-events:none; z-index:9999;
  }

  /* Modal */
  .modal{
    position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:10000;
    background:rgba(0,0,0,.35); backdrop-filter: blur(3px);
  }
  .modal .box{
    width:min(520px, 92vw); background:linear-gradient(180deg, #141622, #0f111a);
    border:1px solid #2a2e42; border-radius:16px; padding:18px; text-align:center;
    box-shadow: 0 20px 60px rgba(0,0,0,.5);
  }
  .modal h2{margin:10px 0 6px; color:var(--gold-2)}
  .modal p{margin:0 0 12px; color:#cfd3da}
</style>
</head>
<body>
  <canvas class="confetti"></canvas>

  <div class="app">
    <!-- LEFT: Wheel -->
    <section class="card">
      <div class="header">
        <div class="title"><span class="dot"></span> Lucky Draw</div>
        <div class="toolbar">
          <button class="btn ghost" id="btnFullscreen" title="Fullscreen">Fullscreen</button>
          <button class="btn ghost" id="btnShuffle" title="Acak urutan">Shuffle</button>
          <button class="btn danger" id="btnClear" title="Kosongkan semua">Reset</button>
        </div>
      </div>
      <div class="stage">
        <div class="wheel-wrap">
          <div class="pointer"></div>
          <svg class="wheel" id="wheel" viewBox="-50 -50 100 100" aria-label="Spin Wheel"></svg>
          <div class="hub"></div>
          <div class="ring"></div>
          <div class="winner-badge" id="winnerBadge">â€”</div>
        </div>
      </div>
      <div class="footer">
        <button class="btn success" id="btnSpin" style="min-width:140px">SPIN</button>
        <button class="btn ghost" id="btnSpinQuick">Spin Cepat</button>
        <span class="pill"><span style="width:8px;height:8px;border-radius:50%;background:var(--gold);display:inline-block;box-shadow:0 0 8px var(--gold)"></span> Lampu aktif</span>
      </div>
    </section>

    <!-- RIGHT: Names control -->
    <section class="card">
      <div class="header">
        <div class="title"><span class="dot"></span> Peserta</div>
        <div class="toolbar">
          <button class="btn" id="btnExport">Export</button>
        </div>
      </div>
      <div class="content list">
        <div class="row-inline">
          <div class="grow">
            <label>Tambah nama</label>
            <input id="nameInput" type="text" placeholder="Contoh: Alex" />
          </div>
          <button class="btn" id="btnAdd">Tambah</button>
        </div>

        <div class="row">
          <label>Import cepat (pisahkan dengan koma atau baris baru)</label>
          <textarea id="bulkInput" placeholder="Ali, Budi, Cindy&#10;Atau satu per baris"></textarea>
          <div class="row-inline">
            <button class="btn" id="btnBulkAdd">Import</button>
            <span class="small">Duplikat otomatis dibuang</span>
          </div>
        </div>

        <div>
          <label>Daftar nama</label>
          <div class="names" id="namesList"></div>
        </div>
      </div>
      <div class="footer">
        <span class="small" id="countInfo">0 nama</span>
      </div>
    </section>
  </div>

  <!-- Winner Modal -->
  <div class="modal" id="winModal" role="dialog" aria-modal="true">
    <div class="box">
      <h2>Pemenang! ðŸŽ‰</h2>
      <p id="winName" style="font-size:24px;font-weight:800;letter-spacing:.4px;color:var(--gold-2)">â€”</p>
      <div class="row-inline" style="justify-content:center">
        <button class="btn" id="btnSpinAgain">Spin Lagi</button>
        <button class="btn ghost" id="btnCloseModal">Tutup</button>
      </div>
    </div>
  </div>

<script>
(function(){
  const LS_KEY = 'lucky_draw_names.v1';
  const wheel = document.getElementById('wheel');
  const badge = document.getElementById('winnerBadge');
  const namesListEl = document.getElementById('namesList');
  const countInfo = document.getElementById('countInfo');
  const confettiCanvas = document.querySelector('canvas.confetti');
  const ctx = confettiCanvas.getContext('2d');
  const winModal = document.getElementById('winModal');
  const winNameEl = document.getElementById('winName');

  let NAMES = loadNames() || ['Alex','Bella','Chong','Dina','Evan','Farah','Gopal','Hana'];
  let spinning = false;
  let currentRotation = 0; // deg

  // ===== Helpers =====
  function saveNames(){ localStorage.setItem(LS_KEY, JSON.stringify(NAMES)); }
  function loadNames(){ try{ return JSON.parse(localStorage.getItem(LS_KEY)||'[]'); }catch{ return [] } }
  function unique(arr){ return [...new Set(arr.map(s=>s.trim()).filter(Boolean))]; }
  function anglePerSlice(){ return 360 / Math.max(NAMES.length,1); }

  // Nice palette generator
  function colorAt(i,total){
    const hue = (i * (360/total) + 20) % 360;
    const s = 75; const l = i % 2 ? 52 : 42;
    return `hsl(${hue} ${s}% ${l}%)`;
  }

  function renderNamesPills(){
    namesListEl.innerHTML = '';
    NAMES.forEach((n,i)=>{
      const pill = document.createElement('span');
      pill.className='name-pill';
      pill.innerHTML = `<b>${escapeHtml(n)}</b>
        <button title="Hapus" data-i="${i}">Ã—</button>`;
      namesListEl.appendChild(pill);
    });
    namesListEl.querySelectorAll('button').forEach(btn=>{
      btn.onclick = ()=>{
        const idx = +btn.dataset.i;
        NAMES.splice(idx,1);
        saveNames(); update();
      }
    });
    countInfo.textContent = `${NAMES.length} nama`;
  }

  function escapeHtml(s){ return s.replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m])) }

  // ===== Wheel SVG render =====
  function renderWheel(){
    const total = Math.max(NAMES.length,1);
    wheel.innerHTML = '';
    const group = document.createElementNS('http://www.w3.org/2000/svg','g');
    const A = 360/total;
    for(let i=0;i<total;i++){
      const start = -90 + i*A, end = start + A; // start from top
      const path = arcPath(0,0,48, start, end);
      const p = document.createElementNS('http://www.w3.org/2000/svg','path');
      p.setAttribute('d', path);
      p.setAttribute('fill', NAMES.length ? colorAt(i,total) : '#1a1d28');
      p.setAttribute('stroke', '#0b0c12');
      p.setAttribute('stroke-width', '0.6');
      group.appendChild(p);

      // Text
      const mid = (start+end)/2;
      const label = document.createElementNS('http://www.w3.org/2000/svg','text');
      const r = 30;
      const x = r*Math.cos(rad(mid)), y = r*Math.sin(rad(mid));
      label.setAttribute('x', x.toFixed(2));
      label.setAttribute('y', y.toFixed(2));
      label.setAttribute('fill', '#f2f3f7');
      label.setAttribute('font-size','4');
      label.setAttribute('font-weight','700');
      label.setAttribute('text-anchor','middle');
      label.setAttribute('dominant-baseline','middle');
      label.textContent = NAMES[i] || 'â€”';
      group.appendChild(label);
    }
    wheel.appendChild(group);
  }

  function rad(deg){ return deg * Math.PI / 180 }
  function arcPath(cx,cy,r, startDeg, endDeg){
    const large = (endDeg - startDeg) > 180 ? 1 : 0;
    const x1 = cx + r * Math.cos(rad(startDeg));
    const y1 = cy + r * Math.sin(rad(startDeg));
    const x2 = cx + r * Math.cos(rad(endDeg));
    const y2 = cy + r * Math.sin(rad(endDeg));
    return `M ${cx} ${cy} L ${x1} ${y1} A ${r} ${r} 0 ${large} 1 ${x2} ${y2} Z`;
  }

  function update(){
    renderWheel();
    renderNamesPills();
    saveNames();
  }

  // ===== Spin logic =====
  function spin(opts={}){
    if(spinning || NAMES.length===0) return;
    spinning = true;
    badge.style.display='none';

    const slice = anglePerSlice();
    // Choose winner index
    const idx = Math.floor(Math.random()*NAMES.length);

    // Target angle so that selected slice lands at pointer (pointer is at 0deg/-90 top)
    // Our slices start from -90 (top). The center of slice i is: -90 + (i+0.5)*slice
    const sliceCenter = -90 + (idx + 0.5) * slice;
    // We want wheel rotated so that sliceCenter aligns with 0deg at the pointer.
    // Pointer fixed at top; rotating wheel negative moves slice under pointer.
    const target = 360* (opts.quick? 5 : 10) + (-sliceCenter);

    const duration = opts.quick ? 2500 : 4800;
    wheel.style.setProperty('--dur', duration+'ms');
    wheel.style.setProperty('--easing', 'cubic-bezier(.12,.05,0,1)');
    currentRotation = (currentRotation + target) % 360;
    wheel.style.setProperty('--deg', currentRotation+'deg');

    playTickSound(duration);

    setTimeout(()=>{
      spinning = false;
      const winner = NAMES[idx];
      badge.textContent = 'Pemenang: ' + winner;
      badge.style.display = 'block';
      showConfetti();
      showWinnerModal(winner);
    }, duration + 60);
  }

  // ===== Confetti =====
  let confettis = [];
  function resizeCanvas(){
    confettiCanvas.width = innerWidth;
    confettiCanvas.height = innerHeight;
  }
  window.addEventListener('resize', resizeCanvas);
  resizeCanvas();

  function makeConfettiBurst(n=200){
    confettis = [];
    for(let i=0;i<n;i++){
      confettis.push({
        x: Math.random()*confettiCanvas.width,
        y: -20 - Math.random()*40,
        vx: (Math.random()-.5)*6,
        vy: Math.random()*2+3,
        g: .05 + Math.random()*.05,
        a: Math.random()*Math.PI,
        va: (Math.random()-.5)*.2,
        s: 4+Math.random()*6,
        c: `hsl(${Math.random()*360} 80% 60%)`,
        life: 200 + Math.random()*120
      });
    }
  }
  function step(){
    ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
    confettis.forEach(p=>{
      p.vy += p.g; p.x += p.vx; p.y += p.vy; p.a += p.va; p.life--;
      ctx.save();
      ctx.translate(p.x,p.y); ctx.rotate(p.a);
      ctx.fillStyle = p.c;
      ctx.fillRect(-p.s/2,-p.s/2,p.s,p.s);
      ctx.restore();
    });
    confettis = confettis.filter(p=>p.life>0 && p.y<confettiCanvas.height+20);
    requestAnimationFrame(step);
  }
  step();

  function showConfetti(){ makeConfettiBurst(220); }

  // ===== Sounds (soft tick) - optional without external files =====
  const audioCtx = window.AudioContext ? new AudioContext() : null;
  function playTickSound(duration){
    if(!audioCtx) return;
    // a short ticking envelope during spin
    const start = audioCtx.currentTime;
    const end = start + duration/1000;
    let t = start;
    const interval = 0.07; // tick spacing
    function tickOnce(at){
      const o = audioCtx.createOscillator();
      const g = audioCtx.createGain();
      o.type='square'; o.frequency.value = 800;
      g.gain.setValueAtTime(0.0001, at);
      g.gain.exponentialRampToValueAtTime(0.12, at+0.005);
      g.gain.exponentialRampToValueAtTime(0.0001, at+0.04);
      o.connect(g).connect(audioCtx.destination);
      o.start(at); o.stop(at+0.05);
    }
    while(t < end){ tickOnce(t); t += interval; }
  }

  // ===== UI bindings =====
  document.getElementById('btnSpin').onclick = ()=>spin();
  document.getElementById('btnSpinQuick').onclick = ()=>spin({quick:true});

  document.getElementById('btnAdd').onclick = ()=>{
    const v = document.getElementById('nameInput').value.trim();
    if(!v) return;
    NAMES = unique([...NAMES, v]); document.getElementById('nameInput').value='';
    update();
  };
  document.getElementById('btnBulkAdd').onclick = ()=>{
    const raw = document.getElementById('bulkInput').value;
    const parts = raw.split(/[\n,;]+/).map(s=>s.trim()).filter(Boolean);
    if(parts.length){ NAMES = unique([...NAMES, ...parts]); document.getElementById('bulkInput').value=''; update(); }
  };
  document.getElementById('btnShuffle').onclick = ()=>{
    for(let i=NAMES.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [NAMES[i],NAMES[j]]=[NAMES[j],NAMES[i]]; }
    update();
  };
  document.getElementById('btnClear').onclick = ()=>{
    if(confirm('Kosongkan semua nama?')){ NAMES = []; update(); }
  };
  document.getElementById('btnExport').onclick = ()=>{
    const blob = new Blob([NAMES.join('\n')], {type:'text/plain'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'lucky-draw-names.txt';
    a.click();
    URL.revokeObjectURL(a.href);
  };
  document.getElementById('btnFullscreen').onclick = ()=>{
    const root = document.documentElement;
    if(!document.fullscreenElement){ root.requestFullscreen?.(); } else { document.exitFullscreen?.(); }
  };

  // Modal controls
  document.getElementById('btnSpinAgain').onclick = ()=>{
    winModal.style.display='none';
    setTimeout(()=>spin(), 200);
  };
  document.getElementById('btnCloseModal').onclick = ()=> winModal.style.display='none';
  winModal.addEventListener('click', (e)=>{ if(e.target===winModal) winModal.style.display='none'; });

  function showWinnerModal(name){
    winNameEl.textContent = name;
    winModal.style.display='flex';
  }

  // Initial render
  update();

  // Keyboard shortcuts
  document.addEventListener('keydown',(e)=>{
    if(e.code==='Space'){ e.preventDefault(); spin(); }
    if((e.ctrlKey||e.metaKey) && e.key.toLowerCase()==='i'){ document.getElementById('nameInput').focus(); }
  });

})();
</script>
</body>
</html>
